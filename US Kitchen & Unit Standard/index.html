<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>US Kitchen & Unit Standard | Cups to Grams Converter</title>
    <meta name="description" content="Professional unit converter optimized for US baking standards. Convert cups of flour/sugar to grams accurately. Includes standard Imperial/Metric tools.">
    
    <!-- Schema Markup for Google Rich Snippets -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Profitnet US Kitchen & Unit Standard",
        "url": "https://testedprofit.com/tools/converter",
        "description": "Professional unit converter optimized for US baking conversions (cups to grams) and engineering standards.",
        "applicationCategory": "UtilityApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "featureList": "Density-based ingredient conversion, Dark mode, Imperial to Metric conversion"
    }
    </script>

    <!-- Tailwind CSS (Use CDN for dev, compile for prod) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0A091B',
                        accent: {
                            teal: '#2DD4BF',
                            emerald: '#10B981'
                        }
                    },
                    animation: {
                        'pulse-slow': 'pulse 8s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Animation Styles -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0A091B;
            color: #E5E7EB;
            line-height: 1.6;
            min-height: 100vh;
        }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Utility */
        .hidden { display: none !important; }
        .fade-in { animation: fadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards; }
        
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(10px); } 
            to { opacity: 1; transform: translateY(0); } 
        }

        /* Mobile Menu Transitions */
        #mobile-menu {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease;
            transform: translateY(-100%);
            opacity: 0;
            pointer-events: none;
        }
        #mobile-menu.active {
            transform: translateY(0);
            opacity: 1;
            pointer-events: auto;
        }
    </style>
</head>
<body class="antialiased overflow-x-hidden relative bg-primary text-gray-200 selection:bg-teal-500/30">

    <!-- Global Background -->
    <div class="fixed inset-0 z-0 pointer-events-none">
        <div class="absolute inset-0 bg-[linear-gradient(rgba(255,255,255,0.03)_1px,transparent_1px),linear-gradient(to_right,rgba(255,255,255,0.03)_1px,transparent_1px)] bg-[size:2.5rem_2.5rem] opacity-40"></div>
        <div class="absolute inset-0 bg-[radial-gradient(circle_at_30%_20%,rgba(45,212,191,0.15)_0%,transparent_60%),radial-gradient(circle_at_70%_80%,rgba(96,165,250,0.1)_0%,transparent_60%)] animate-pulse-slow"></div>
    </div>

    <!-- Header -->
    <header class="fixed w-full top-0 z-50 bg-slate-950/80 backdrop-blur-md border-b border-white/5 transition-all duration-300">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            
            <!-- Logo -->
            <a href="/" class="flex items-center space-x-3 group" aria-label="Go to Homepage">
                <img src="https://emerald-urgent-cuckoo-166.mypinata.cloud/ipfs/bafybeibelhobbfhgcur4j5qmnzvnjlfkpwawy3rttzdnfr4t22ikcj263m" 
                     class="h-8 w-8 transition-transform group-hover:rotate-12" 
                     alt="Profitnet Logo"
                     width="32" height="32" fetchpriority="high">
                <span class="text-xl font-bold tracking-tight text-white">Profitnet</span>
            </a>
            
            <!-- Desktop Nav -->
            <nav class="hidden lg:flex space-x-10 items-center">
                <a href="/" class="text-sm font-bold text-white hover:text-accent-emerald transition-colors duration-200">HOME</a>
                <a href="https://testedprofit.com/pages/landmarks/" target="_blank" rel="noopener noreferrer" class="text-xs font-bold uppercase tracking-widest text-accent-emerald hover:text-emerald-300 transition-colors duration-200">Landmarks</a>
                <a href="https://testedprofit.com/pages/PNET/" target="_blank" rel="noopener noreferrer" class="px-6 py-2 rounded-full border border-teal-500/30 text-[10px] font-black text-teal-400 hover:bg-teal-500/10 hover:border-teal-500/60 hover:shadow-[0_0_15px_rgba(45,212,191,0.2)] transition-all duration-300 uppercase tracking-[0.2em]">
                    $PNET Asset Dashboard
                </a>
            </nav>

            <!-- Mobile Menu Button -->
            <button id="mobile-menu-btn" class="lg:hidden text-white p-2 hover:bg-white/5 rounded-lg transition-colors" aria-label="Open Menu">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
            </button>
        </div>

        <!-- Mobile Menu Overlay -->
        <div id="mobile-menu" class="fixed inset-0 bg-slate-950/95 backdrop-blur-xl z-40 lg:hidden flex flex-col items-center justify-center space-y-8">
            <button id="close-menu-btn" class="absolute top-6 right-6 text-white p-2 hover:bg-white/10 rounded-full transition-colors" aria-label="Close Menu">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
            </button>

            <a href="/" class="text-xl font-black text-white uppercase tracking-widest hover:text-accent-emerald transition-colors">Home</a>
            <a href="https://testedprofit.com/pages/landmarks/" target="_blank" rel="noopener noreferrer" class="text-xl font-black text-accent-emerald uppercase tracking-widest hover:text-emerald-300 transition-colors">Landmarks</a>
            <a href="https://testedprofit.com/pages/PNET/" target="_blank" rel="noopener noreferrer" class="text-xl font-black text-white uppercase tracking-widest hover:text-teal-400 transition-colors">$PNET Dashboard</a>
        </div>
    </header>

    <!-- Main Content -->
    <main class="relative z-10 pt-32 container mx-auto px-4 md:px-6 pb-20">
        
        <!-- Hero Section -->
        <div class="text-center mb-12 max-w-3xl mx-auto fade-in" style="animation-delay: 0.1s;">
            <div class="inline-flex items-center gap-2 py-1 px-3 rounded-full bg-teal-500/10 border border-teal-500/20 text-accent-teal text-[10px] font-bold tracking-widest uppercase mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><path d="m9 12 2 2 4-4"/></svg>
                <span>Verified Secure & Accurate</span>
            </div>
            <h1 class="text-4xl md:text-5xl font-black mb-6 text-white tracking-tight">
               US Kitchen & Unit <span class="text-accent-teal">Standard</span>
            </h1>
            <p class="text-gray-400 text-lg leading-relaxed">
              The professional choice for <strong class="text-gray-200">US to Metric conversions</strong>. 
              Features a dedicated <strong class="text-gray-200">Baking Mode</strong> for converting cups of flour and sugar to grams with density precision.
            </p>
        </div>

        <!-- Tab Navigation -->
        <div class="flex flex-wrap justify-center gap-3 mb-10 fade-in" style="animation-delay: 0.2s;">
            <button onclick="switchCategory('common')" id="btn-cat-common" class="cat-btn flex items-center gap-2 px-6 py-3 rounded-full text-sm font-bold uppercase tracking-wide transition-all bg-gradient-to-r from-teal-500 to-emerald-500 text-white shadow-lg shadow-teal-500/20">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1z"/><path d="m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1z"/><path d="M7 21h10"/><path d="M12 3v18"/><path d="M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2"/></svg>
                Essentials
            </button>
            <button onclick="switchCategory('kitchen')" id="btn-cat-kitchen" class="cat-btn flex items-center gap-2 px-6 py-3 rounded-full text-sm font-bold uppercase tracking-wide transition-all bg-[#16182D] border border-white/5 text-gray-400 hover:text-white hover:border-white/10">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 13.87A8 8 0 0 1 6 10l-1-2.4 6-6.4 6 6.4-1 2.4a8 8 0 0 1 0 3.87"/><path d="M6 13.87V22h12v-8.13"/><path d="M6 10h12"/></svg>
                Smart Kitchen
            </button>
            <button onclick="switchCategory('science')" id="btn-cat-science" class="cat-btn flex items-center gap-2 px-6 py-3 rounded-full text-sm font-bold uppercase tracking-wide transition-all bg-[#16182D] border border-white/5 text-gray-400 hover:text-white hover:border-white/10">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14H4z"/></svg>
                Science
            </button>
        </div>

        <!-- Sub-Category Chips -->
        <div id="subcategory-container" class="flex flex-wrap justify-center gap-2 mb-8 fade-in" style="animation-delay: 0.3s;">
            <!-- Injected via JS -->
        </div>

        <!-- Main Converter Card -->
        <div class="relative min-h-[400px] w-full max-w-2xl mx-auto fade-in" style="animation-delay: 0.4s;">
            
            <!-- Generic Mode -->
            <div id="generic-converter" class="w-full">
                <div class="flex flex-col md:flex-row gap-4 items-center justify-center p-6 bg-[#0F1021] rounded-2xl border border-white/5 shadow-2xl relative overflow-hidden">
                    <!-- Glow -->
                    <div class="absolute top-0 right-0 w-32 h-32 bg-teal-500/5 rounded-full blur-2xl -mr-16 -mt-16 pointer-events-none"></div>

                    <!-- Input -->
                    <div class="flex-1 w-full space-y-2 z-10">
                        <label class="text-[10px] font-bold text-gray-500 uppercase tracking-widest ml-1">From</label>
                        <div class="flex bg-[#16182D] rounded-xl overflow-hidden ring-1 ring-white/5 focus-within:ring-accent-teal transition-all">
                            <input type="number" id="gen-input" value="1" class="w-full bg-transparent p-4 text-2xl font-bold text-white outline-none placeholder:text-gray-600" placeholder="0">
                            <div class="relative border-l border-white/5">
                                <select id="gen-from-unit" class="h-full bg-[#1A1D36] pl-4 pr-8 text-sm font-medium text-gray-300 outline-none appearance-none cursor-pointer hover:bg-[#222542] transition-colors w-32">
                                    <!-- Injected JS -->
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Swap -->
                    <button onclick="swapGeneric()" class="p-3 rounded-full bg-[#1A1D36] hover:bg-accent-teal hover:text-primary text-gray-400 transition-all transform hover:rotate-180 z-10">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/></svg>
                    </button>

                    <!-- Output -->
                    <div class="flex-1 w-full space-y-2 z-10">
                        <label class="text-[10px] font-bold text-accent-teal uppercase tracking-widest ml-1">Result</label>
                        <div class="flex bg-[#131F2A] rounded-xl overflow-hidden ring-1 ring-accent-teal/30">
                            <div id="gen-result" class="w-full p-4 text-2xl font-bold text-accent-teal overflow-x-auto whitespace-nowrap scrollbar-hide">
                                -
                            </div>
                            <div class="relative border-l border-accent-teal/20">
                                <select id="gen-to-unit" class="h-full bg-transparent pl-4 pr-8 text-sm font-medium text-teal-200/80 outline-none appearance-none cursor-pointer hover:bg-teal-900/20 transition-colors w-32">
                                    <!-- Injected JS -->
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Table -->
                <div id="quick-table" class="mt-8 grid grid-cols-2 md:grid-cols-4 gap-3 text-xs text-gray-400">
                    <!-- Injected JS -->
                </div>
            </div>

            <!-- Kitchen Mode -->
            <div id="kitchen-converter" class="w-full hidden">
                <!-- Tip Box -->
                <div class="bg-amber-900/10 border border-amber-500/20 p-4 rounded-xl mb-6 flex items-start gap-3">
                    <div class="p-2 bg-amber-500/10 rounded-lg text-amber-400 shrink-0">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 13.87A8 8 0 0 1 6 10l-1-2.4 6-6.4 6 6.4-1 2.4a8 8 0 0 1 0 3.87"/><path d="M6 13.87V22h12v-8.13"/><path d="M6 10h12"/></svg>
                    </div>
                    <div>
                        <h3 class="text-sm font-bold text-amber-200">Why convert by weight?</h3>
                        <p class="text-xs text-amber-200/60 mt-1 leading-relaxed">
                            US recipes often use volumes (Cups), but density varies. 
                            <span class="hidden sm:inline"> 1 Cup of Flour (~120g) weighs much less than 1 Cup of Sugar (~200g).</span> 
                            This tool uses density for perfect baking results.
                        </p>
                    </div>
                </div>

                <div class="flex flex-col gap-6 p-6 bg-[#0F1021] rounded-2xl border border-white/5 shadow-2xl relative">
                    
                    <!-- Ingredient -->
                    <div class="w-full">
                       <label class="text-[10px] font-bold text-gray-500 uppercase tracking-widest ml-1 mb-2 block">Ingredient</label>
                       <select id="k-ingredient" class="w-full p-4 bg-[#16182D] border border-white/5 rounded-xl text-lg font-medium text-white outline-none focus:border-accent-teal transition-colors appearance-none cursor-pointer">
                           <!-- Injected JS -->
                       </select>
                    </div>
            
                    <div class="flex flex-col md:flex-row gap-4 items-center">
                      <!-- From -->
                      <div class="flex-1 w-full space-y-2">
                        <div class="flex bg-[#16182D] rounded-xl overflow-hidden ring-1 ring-white/5 focus-within:ring-accent-teal">
                          <input type="number" id="k-input" value="1" class="w-full bg-transparent p-4 text-2xl font-bold text-white outline-none" placeholder="0">
                          <div class="relative border-l border-white/5">
                            <select id="k-from-unit" class="h-full bg-[#1A1D36] pl-4 pr-8 text-sm font-medium text-gray-300 outline-none appearance-none cursor-pointer w-32">
                                <!-- Injected JS -->
                            </select>
                          </div>
                        </div>
                      </div>
            
                      <div class="text-gray-500">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/></svg>
                      </div>
            
                      <!-- To -->
                      <div class="flex-1 w-full space-y-2">
                        <div class="flex bg-[#131F2A] rounded-xl overflow-hidden ring-1 ring-accent-teal/30">
                          <div id="k-result" class="w-full p-4 text-2xl font-bold text-accent-teal overflow-x-auto">
                            -
                          </div>
                          <div class="relative border-l border-accent-teal/20">
                            <select id="k-to-unit" class="h-full bg-transparent pl-4 pr-8 text-sm font-medium text-teal-200/80 outline-none appearance-none cursor-pointer w-32">
                                <!-- Injected JS -->
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
            </div>

        </div>
    </main>

    <!-- App Logic -->
    <script>
        // --- Data ---
        const UNITS = {
            length: {
                units: {
                    m: { label: 'Meters', factor: 1 },
                    cm: { label: 'Centimeters', factor: 0.01 },
                    mm: { label: 'Millimeters', factor: 0.001 },
                    km: { label: 'Kilometers', factor: 1000 },
                    in: { label: 'Inches', factor: 0.0254 },
                    ft: { label: 'Feet', factor: 0.3048 },
                    yd: { label: 'Yards', factor: 0.9144 },
                    mi: { label: 'Miles', factor: 1609.344 },
                }
            },
            weight: {
                units: {
                    kg: { label: 'Kilograms', factor: 1 },
                    g: { label: 'Grams', factor: 0.001 },
                    mg: { label: 'Milligrams', factor: 0.000001 },
                    lb: { label: 'Pounds', factor: 0.453592 },
                    oz: { label: 'Ounces', factor: 0.0283495 },
                }
            },
            temperature: {
                units: {
                    c: { label: 'Celsius' },
                    f: { label: 'Fahrenheit' },
                    k: { label: 'Kelvin' }
                }
            },
            volume: {
                units: {
                    l: { label: 'Liters', factor: 1 },
                    ml: { label: 'Milliliters', factor: 0.001 },
                    gal: { label: 'Gallons (US)', factor: 3.78541 },
                    qt: { label: 'Quarts (US)', factor: 0.946353 },
                    pt: { label: 'Pints (US)', factor: 0.473176 },
                    cup: { label: 'Cups (US)', factor: 0.236588 },
                    floz: { label: 'Fluid Ounces', factor: 0.0295735 },
                }
            },
            speed: {
                units: {
                    mps: { label: 'Meters/Sec', factor: 1 },
                    kph: { label: 'Km/Hour', factor: 0.277778 },
                    mph: { label: 'Miles/Hour', factor: 0.44704 },
                    kn: { label: 'Knots', factor: 0.514444 },
                }
            },
            pressure: {
                units: {
                    pa: { label: 'Pascals', factor: 1 },
                    bar: { label: 'Bar', factor: 100000 },
                    psi: { label: 'PSI', factor: 6894.76 },
                    atm: { label: 'Atmosphere', factor: 101325 },
                }
            },
            energy: {
                units: {
                    j: { label: 'Joules', factor: 1 },
                    kj: { label: 'Kilojoules', factor: 1000 },
                    cal: { label: 'Calories', factor: 4.184 },
                    kcal: { label: 'Kilocalories', factor: 4184 },
                    wh: { label: 'Watt-hour', factor: 3600 },
                    kwh: { label: 'Kilowatt-hour', factor: 3600000 },
                }
            }
        };

        const INGREDIENTS = [
            { id: 'flour_ap', label: 'All-Purpose Flour', density: 120 },
            { id: 'flour_cake', label: 'Cake Flour', density: 113 },
            { id: 'sugar_gran', label: 'Sugar (Granulated)', density: 200 },
            { id: 'sugar_pow', label: 'Sugar (Powdered)', density: 120 },
            { id: 'sugar_brown', label: 'Sugar (Brown, packed)', density: 220 },
            { id: 'butter', label: 'Butter', density: 227 },
            { id: 'water', label: 'Water / Milk', density: 236 },
            { id: 'oil', label: 'Vegetable Oil', density: 218 },
            { id: 'cocoa', label: 'Cocoa Powder', density: 85 },
            { id: 'rice', label: 'Rice (Uncooked)', density: 185 },
            { id: 'oats', label: 'Rolled Oats', density: 90 },
        ];

        const KITCHEN_UNITS = {
            vol: [
                { id: 'cup', label: 'Cups (US)', factor: 1 },
                { id: 'tbsp', label: 'Tablespoons', factor: 0.0625 },
                { id: 'tsp', label: 'Teaspoons', factor: 0.0208333 },
                { id: 'ml', label: 'Milliliters', factor: 0.00422675 },
                { id: 'l', label: 'Liters', factor: 4.22675 },
                { id: 'floz', label: 'Fluid Oz', factor: 0.125 },
            ],
            mass: [
                { id: 'g', label: 'Grams', factor: 1 },
                { id: 'kg', label: 'Kilograms', factor: 1000 },
                { id: 'oz', label: 'Ounces', factor: 28.3495 },
                { id: 'lb', label: 'Pounds', factor: 453.592 },
            ]
        };

        const CATEGORIES = {
            common: ['length', 'weight', 'temperature', 'volume'],
            science: ['speed', 'pressure', 'energy'],
            kitchen: [] // Special handling
        };

        // --- State ---
        let currentCategory = 'common';
        let currentSubcategory = 'length';
        
        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            initMenu();
            renderSubcategories();
            initKitchen();
            updateGenericUI();
        });

        // --- Logic: Generic ---
        function switchCategory(cat) {
            currentCategory = cat;
            
            // Update Tab Styles
            document.querySelectorAll('.cat-btn').forEach(btn => {
                btn.className = "cat-btn flex items-center gap-2 px-6 py-3 rounded-full text-sm font-bold uppercase tracking-wide transition-all bg-[#16182D] border border-white/5 text-gray-400 hover:text-white hover:border-white/10";
            });
            const activeBtn = document.getElementById(`btn-cat-${cat}`);
            activeBtn.className = "cat-btn flex items-center gap-2 px-6 py-3 rounded-full text-sm font-bold uppercase tracking-wide transition-all bg-gradient-to-r from-teal-500 to-emerald-500 text-white shadow-lg shadow-teal-500/20";

            const subContainer = document.getElementById('subcategory-container');
            const genConverter = document.getElementById('generic-converter');
            const kitchenConverter = document.getElementById('kitchen-converter');

            if (cat === 'kitchen') {
                subContainer.classList.add('hidden');
                genConverter.classList.add('hidden');
                kitchenConverter.classList.remove('hidden');
            } else {
                subContainer.classList.remove('hidden');
                genConverter.classList.remove('hidden');
                kitchenConverter.classList.add('hidden');
                currentSubcategory = CATEGORIES[cat][0];
                renderSubcategories();
                updateGenericUI();
            }
        }

        function renderSubcategories() {
            const container = document.getElementById('subcategory-container');
            container.innerHTML = '';
            CATEGORIES[currentCategory].forEach(sub => {
                const btn = document.createElement('button');
                btn.className = `px-4 py-2 rounded-lg text-xs font-bold uppercase tracking-widest transition-all ${sub === currentSubcategory ? 'bg-white/10 text-accent-teal border border-accent-teal/20' : 'text-gray-500 hover:text-gray-300 hover:bg-white/5'}`;
                btn.textContent = sub;
                btn.onclick = () => {
                    currentSubcategory = sub;
                    renderSubcategories(); // Re-render to update active state
                    updateGenericUI();
                };
                container.appendChild(btn);
            });
        }

        function updateGenericUI() {
            const fromSelect = document.getElementById('gen-from-unit');
            const toSelect = document.getElementById('gen-to-unit');
            const input = document.getElementById('gen-input');

            // Populate options
            const unitData = UNITS[currentSubcategory].units;
            const optionsHtml = Object.entries(unitData).map(([key, u]) => `<option value="${key}">${u.label}</option>`).join('');
            
            // Preserve selection if possible, else default
            const oldFrom = fromSelect.value;
            const oldTo = toSelect.value;
            
            fromSelect.innerHTML = optionsHtml;
            toSelect.innerHTML = optionsHtml;

            // Smart defaults
            if (unitData[oldFrom]) fromSelect.value = oldFrom;
            else setDefaultUnits(fromSelect, toSelect);
            
            if (unitData[oldTo]) toSelect.value = oldTo;

            // Bind events
            input.oninput = calcGeneric;
            fromSelect.onchange = calcGeneric;
            toSelect.onchange = calcGeneric;

            calcGeneric();
        }

        function setDefaultUnits(fromEl, toEl) {
            const keys = Object.keys(UNITS[currentSubcategory].units);
            if (currentSubcategory === 'length') { fromEl.value = 'ft'; toEl.value = 'm'; }
            else if (currentSubcategory === 'weight') { fromEl.value = 'lb'; toEl.value = 'kg'; }
            else if (currentSubcategory === 'temperature') { fromEl.value = 'f'; toEl.value = 'c'; }
            else { fromEl.value = keys[0]; toEl.value = keys[1] || keys[0]; }
        }

        function swapGeneric() {
            const fromEl = document.getElementById('gen-from-unit');
            const toEl = document.getElementById('gen-to-unit');
            const temp = fromEl.value;
            fromEl.value = toEl.value;
            toEl.value = temp;
            calcGeneric();
        }

        function calcGeneric() {
            const val = parseFloat(document.getElementById('gen-input').value);
            const from = document.getElementById('gen-from-unit').value;
            const to = document.getElementById('gen-to-unit').value;
            const resultEl = document.getElementById('gen-result');
            const tableEl = document.getElementById('quick-table');

            if (isNaN(val)) { resultEl.innerText = '-'; return; }

            // Math
            let result;
            if (currentSubcategory === 'temperature') {
                let celsius;
                if (from === 'c') celsius = val;
                else if (from === 'f') celsius = (val - 32) * (5/9);
                else if (from === 'k') celsius = val - 273.15;

                if (to === 'c') result = celsius;
                else if (to === 'f') result = (celsius * 9/5) + 32;
                else if (to === 'k') result = celsius + 273.15;
            } else {
                const u = UNITS[currentSubcategory].units;
                result = (val * u[from].factor) / u[to].factor;
            }

            resultEl.innerText = formatNumber(result);

            // Update Quick Table
            tableEl.innerHTML = [1, 5, 10, 50].map(v => {
                let r;
                // Duplicate math for quick table (simplified)
                if (currentSubcategory === 'temperature') {
                    // Just recall helper if we refactored, but inline for now is robust
                    let c;
                     if (from === 'c') c = v; else if (from === 'f') c = (v - 32) * (5/9); else c = v - 273.15;
                     if (to === 'c') r = c; else if (to === 'f') r = (c * 9/5) + 32; else r = c + 273.15;
                } else {
                    const u = UNITS[currentSubcategory].units;
                    r = (v * u[from].factor) / u[to].factor;
                }
                const labelFrom = UNITS[currentSubcategory].units[from].label;
                const labelTo = UNITS[currentSubcategory].units[to].label;
                return `<div class="p-3 rounded-lg bg-[#0F1021]/50 border border-white/5 text-center hover:bg-[#1A1D36] transition-colors">
                    ${v} ${labelFrom} <br/> <span class="text-accent-teal font-mono">= ${formatNumber(r)} ${labelTo}</span>
                </div>`;
            }).join('');
        }

        // --- Logic: Kitchen ---
        function initKitchen() {
            const ingSelect = document.getElementById('k-ingredient');
            ingSelect.innerHTML = INGREDIENTS.map(i => `<option value="${i.id}">${i.label}</option>`).join('');
            
            const fromSelect = document.getElementById('k-from-unit');
            const toSelect = document.getElementById('k-to-unit');
            
            const volOpts = `<optgroup label="Volume">${KITCHEN_UNITS.vol.map(u => `<option value="${u.id}">${u.label}</option>`).join('')}</optgroup>`;
            const massOpts = `<optgroup label="Weight">${KITCHEN_UNITS.mass.map(u => `<option value="${u.id}">${u.label}</option>`).join('')}</optgroup>`;
            
            fromSelect.innerHTML = volOpts + massOpts;
            toSelect.innerHTML = massOpts + volOpts;

            // Defaults
            fromSelect.value = 'cup';
            toSelect.value = 'g';

            // Bind
            document.getElementById('k-input').oninput = calcKitchen;
            ingSelect.onchange = calcKitchen;
            fromSelect.onchange = calcKitchen;
            toSelect.onchange = calcKitchen;
        }

        function calcKitchen() {
            const val = parseFloat(document.getElementById('k-input').value);
            if (isNaN(val)) { document.getElementById('k-result').innerText = '-'; return; }

            const ingId = document.getElementById('k-ingredient').value;
            const fromId = document.getElementById('k-from-unit').value;
            const toId = document.getElementById('k-to-unit').value;

            const ingredient = INGREDIENTS.find(i => i.id === ingId);
            const gramsPerCup = ingredient.density;

            const fromIsVol = KITCHEN_UNITS.vol.find(u => u.id === fromId);
            const toIsVol = KITCHEN_UNITS.vol.find(u => u.id === toId);

            let grams = 0;
            // Input -> Grams
            if (fromIsVol) {
                // Volume to Mass requires density
                const cups = val * fromIsVol.factor;
                grams = cups * gramsPerCup;
            } else {
                // Mass to Mass is just factor
                const fromUnit = KITCHEN_UNITS.mass.find(u => u.id === fromId);
                grams = val * fromUnit.factor;
            }

            // Grams -> Output
            let result = 0;
            if (toIsVol) {
                // Mass to Volume requires density
                const cups = grams / gramsPerCup;
                result = cups / toIsVol.factor;
            } else {
                const toUnit = KITCHEN_UNITS.mass.find(u => u.id === toId);
                result = grams / toUnit.factor;
            }

            document.getElementById('k-result').innerText = formatNumber(result);
        }

        // --- Helpers ---
        function formatNumber(num) {
            if (!num && num !== 0) return '';
            const n = parseFloat(num);
            if (Math.abs(n) < 0.0001 || Math.abs(n) > 1000000) return n.toExponential(4);
            return Number(n.toPrecision(6)).toString();
        }

        function initMenu() {
            const menuBtn = document.getElementById('mobile-menu-btn');
            const closeBtn = document.getElementById('close-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            const body = document.body;

            function toggleMenu(show) {
                if (show) {
                    mobileMenu.classList.add('active');
                    body.style.overflow = 'hidden';
                } else {
                    mobileMenu.classList.remove('active');
                    body.style.overflow = '';
                }
            }

            menuBtn.addEventListener('click', () => toggleMenu(true));
            closeBtn.addEventListener('click', () => toggleMenu(false));
            mobileMenu.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => toggleMenu(false));
            });
        }
    </script>
</body>
</html>
